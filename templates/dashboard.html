{% extends "base.html" %}
{% block title %}Dashboard{% endblock %}

{% block content %}
    <div class="p-4 position-relative">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h2>Welcome, {{ current_user.username }}</h2>
            <a href="{{ url_for('auth.logout') }}" class="btn btn-danger">Logout</a>
        </div>

        <h3 class="mb-4">My Cloud Storage</h3>

        <!-- Upload form -->
        <form action="/upload" enctype="multipart/form-data" method="POST" class="mb-4">
            <input class="form-control mb-2" type="file" name="file" required multiple>
            <button class="btn btn-success">Upload</button>
        </form>

        <!-- File table -->
        <table class="table table-bordered table-striped">
            <thead class="table-dark">
            <tr>
                <th>File Name</th>
                <th>Size</th>
                <th style="width: 300px">Action</th>
            </tr>
            </thead>
            <tbody>
            {% for file in files %}
                <tr>
                    <td>{{ file.filename }}</td>
                    <td>{{ file.size }} KB</td>
                    <td>
                        <a class="btn btn-primary btn-sm"
                           href="{{ url_for('file.download_file', file_id=file.id) }}">Download</a>
                        <form action="{{ url_for('file.delete_file', file_id=file.id) }}" method="POST"
                              style="display: inline">
                            <button class="btn btn-danger btn-sm" onclick="return confirm('confirm?')">Delete</button>
                        </form>
                    </td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    </div>
{% endblock %}
